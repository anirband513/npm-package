import { useState } from 'react'
{{#hasAntd}}
import { Layout, Menu, Badge, Button, Drawer, Typography, Space, Avatar, Dropdown } from 'antd'
import {
  ShoppingCartOutlined,
  HeartOutlined,
  UserOutlined,
  ShoppingOutlined,
  HomeOutlined,
  TagsOutlined,
  LogoutOutlined,
  LoginOutlined,
} from '@ant-design/icons'
{{/hasAntd}}
{{#hasRouter}}
import { Routes, Route, Link, useLocation } from 'react-router-dom'
import Home from './pages/Home'
import Products from './pages/Products'
import ProductDetail from './pages/ProductDetail'
import Cart from './pages/Cart'
import Checkout from './pages/Checkout'
{{/hasRouter}}
{{#hasRedux}}
import { useSelector } from 'react-redux'
{{/hasRedux}}
{{#hasScss}}
import './index.scss'
{{/hasScss}}
{{^hasScss}}
import './index.css'
{{/hasScss}}

{{#hasAntd}}
const { Header, Content, Footer } = Layout
const { Title, Text } = Typography
{{/hasAntd}}

{{#isTypeScript}}
function App(): JSX.Element {
{{/isTypeScript}}
{{^isTypeScript}}
function App() {
{{/isTypeScript}}
  {{#hasAntd}}
  // Style constants
  const layoutStyle = { minHeight: '100vh' }
  const headerStyle = {
    position: 'sticky' as const,
    top: 0,
    zIndex: 1000,
    width: '100%',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'space-between',
    background: '#fff',
    boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
    padding: '0 24px',
  }
  const logoContainerStyle = { display: 'flex', alignItems: 'center', gap: '24px' }
  const logoStyle = { margin: 0, color: '#1890ff' }
  const menuStyle = { border: 'none', flex: 1, minWidth: 400 }
  const iconStyle = { fontSize: '20px', cursor: 'pointer' }
  const userDropdownStyle = { cursor: 'pointer' }
  const contentStyle = { padding: '24px', background: '#f0f2f5', minHeight: 'calc(100vh - 134px)' }
  const footerStyle = { textAlign: 'center' as const, background: '#001529', color: 'white' }

  const dropdownMenuConfig = { items: userMenuItems }
  {{/hasAntd}}

  const [cartDrawerVisible, setCartDrawerVisible] = useState(false)
  {{#hasRouter}}
  const location = useLocation()
  {{/hasRouter}}
  {{#hasRedux}}
  const cartItems = useSelector((state{{#isTypeScript}}: any{{/isTypeScript}}) => state.cart?.items || [])
  const cartCount = cartItems.reduce((total{{#isTypeScript}}: number{{/isTypeScript}}, item{{#isTypeScript}}: any{{/isTypeScript}}) => total + item.quantity, 0)
  {{/hasRedux}}
  {{^hasRedux}}
  const [cartCount] = useState(0)
  {{/hasRedux}}

  const userMenuItems = [
    {
      key: 'profile',
      icon: <UserOutlined />,
      label: 'My Profile',
    },
    {
      key: 'orders',
      icon: <ShoppingOutlined />,
      label: 'My Orders',
    },
    {
      key: 'wishlist',
      icon: <HeartOutlined />,
      label: 'Wishlist',
    },
    {
      type: 'divider',
    },
    {
      key: 'logout',
      icon: <LogoutOutlined />,
      label: 'Logout',
      danger: true,
    },
  ]

  {{#hasRouter}}
  return (
    {{#hasAntd}}
    <Layout style={layoutStyle}>
      <Header style={headerStyle}>
        <div style={logoContainerStyle}>
          <Title level={3} style={logoStyle}>
            <ShoppingOutlined /> {{projectName}}
          </Title>
          <Menu
            mode="horizontal"
            selectedKeys={[location.pathname]}
            style={menuStyle}
            items={[
              {
                key: '/',
                icon: <HomeOutlined />,
                label: <Link to="/">Home</Link>,
              },
              {
                key: '/products',
                icon: <TagsOutlined />,
                label: <Link to="/products">Products</Link>,
              },
            ]}
          />
        </div>
        <Space size="large">
          <Badge count={0} showZero={false}>
            <HeartOutlined style={iconStyle} />
          </Badge>
          <Badge count={cartCount} showZero>
            <Link to="/cart">
              <ShoppingCartOutlined style={iconStyle} />
            </Link>
          </Badge>
          <Dropdown menu={dropdownMenuConfig} placement="bottomRight">
            <Space style={userDropdownStyle}>
              <Avatar icon={<UserOutlined />} />
              <Text>Guest</Text>
            </Space>
          </Dropdown>
        </Space>
      </Header>
      
      <Content style={contentStyle}>
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/products" element={<Products />} />
          <Route path="/product/:id" element={<ProductDetail />} />
          <Route path="/cart" element={<Cart />} />
          <Route path="/checkout" element={<Checkout />} />
        </Routes>
      </Content>
      
      <Footer style={footerStyle}>
        {{projectName}} ©{new Date().getFullYear()} - Built with Vite + React {{#isTypeScript}}+ TypeScript{{/isTypeScript}}
      </Footer>
    </Layout>
    {{/hasAntd}}
    {{^hasAntd}}
    <div className="ecommerce-layout">
      <header className="ecommerce-header">
        <h1>{{projectName}}</h1>
        <nav>
          <Link to="/">Home</Link>
          <Link to="/products">Products</Link>
          <Link to="/cart">Cart ({cartCount})</Link>
        </nav>
      </header>
      <main className="ecommerce-content">
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/products" element={<Products />} />
          <Route path="/product/:id" element={<ProductDetail />} />
          <Route path="/cart" element={<Cart />} />
          <Route path="/checkout" element={<Checkout />} />
        </Routes>
      </main>
      <footer className="ecommerce-footer">
        <p>{{projectName}} ©{new Date().getFullYear()}</p>
      </footer>
    </div>
    {{/hasAntd}}
  )
  {{/hasRouter}}
  {{^hasRouter}}
  return (
    <div>
      <h1>{{projectName}} E-commerce</h1>
      <p>Please enable React Router for the full e-commerce experience</p>
    </div>
  )
  {{/hasRouter}}
}

export default App
